:root{--primary-color: #646cff;--bg-color: #ffffff;--header-bg: rgba(255, 255, 255, .9);--chat-bg: #f8f9fa;--bubble-ai: #ffffff;--bubble-user: #646cff;--text-primary: #333;--border-color: #e1e4e8}@media (prefers-color-scheme: dark){:root{--bg-color: #1a1a1a;--header-bg: rgba(26, 26, 26, .9);--chat-bg: #111;--bubble-ai: #2a2a2a;--bubble-user: #535bf2;--text-primary: #fff;--border-color: #333}}.animate-spin{animation:spin 1s linear infinite}*{box-sizing:border-box}html{overscroll-behavior:none;overflow-x:hidden}body{margin:0;font-family:Inter,system-ui,-apple-system,sans-serif;background-color:var(--chat-bg);color:var(--text-primary);overscroll-behavior:none;overflow-x:hidden}.app-container{display:flex;flex-direction:column;height:100dvh;max-width:800px;margin:0 auto;background-color:var(--bg-color);position:relative;box-shadow:0 0 20px #0000001a}.header{height:60px;display:flex;align-items:center;justify-content:center;border-bottom:1px solid var(--border-color);background-color:var(--header-bg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);position:absolute;top:0;left:0;right:0;z-index:10}.header-content{display:flex;flex-direction:column;align-items:center;gap:2px}.header-content h1{font-size:1rem;margin:0;opacity:.8}.model-selector{display:flex;align-items:center;gap:4px;cursor:pointer;position:relative}.model-select{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border:none;font-family:inherit;font-size:.85rem;font-weight:600;color:var(--text-primary);padding-right:4px;cursor:pointer;text-align:center}.model-select:focus{outline:none}.select-icon{pointer-events:none;opacity:.6}.chat-area{flex:1;overflow-y:auto;padding:80px 16px;display:flex;flex-direction:column;gap:16px;overscroll-behavior-y:contain}.message-row{display:flex;gap:12px;max-width:92%}.user-row{align-self:flex-end;flex-direction:row-reverse}.ai-row{align-self:flex-start}.avatar{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;overflow:hidden}.avatar.ai,.avatar.user{background-color:#e1e4e8;color:#333}.message-content{display:flex;flex-direction:column;gap:4px}.model-badge{font-size:.7rem;color:#666;margin-left:2px}.message-bubble{padding:12px 16px;border-radius:18px;font-size:.95rem;line-height:1.5;box-shadow:0 1px 2px #0000000d;white-space:pre-wrap}.ai-row .message-bubble{background-color:var(--bubble-ai);border-top-left-radius:4px}.user-row .message-bubble{background-color:var(--bubble-user);color:#fff;border-top-right-radius:4px}.input-area{position:absolute;bottom:0;left:0;right:0;padding:8px;background-color:var(--bg-color);border-top:1px solid var(--border-color);display:flex;align-items:flex-end;gap:8px}.input-actions-left{display:flex;gap:4px;padding-bottom:4px;flex-shrink:0}.input-wrapper-container{flex:1;display:flex;flex-direction:column;gap:8px;min-width:0}.input-wrapper{background-color:var(--chat-bg);border-radius:24px;padding:8px 16px;display:flex;align-items:center}.active-files-list{display:flex;gap:8px;overflow-x:auto;padding-bottom:4px;scrollbar-width:none;-ms-overflow-style:none}.active-files-list::-webkit-scrollbar{display:none}.active-file-preview{display:inline-flex;align-items:center;gap:6px;background-color:#f0f0f0;padding:4px 10px;border-radius:12px;font-size:.8rem;border:1px solid #ddd;white-space:nowrap;flex-shrink:0;color:#333}.file-name{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.remove-file-btn{background:none;border:none;cursor:pointer;padding:2px;display:flex;align-items:center;opacity:.6}.file-attachment-bubble{display:flex;align-items:center;gap:6px;background-color:#0000000d;padding:6px 10px;border-radius:8px;margin-bottom:6px;font-size:.85rem;font-weight:500}textarea{width:100%;border:none;background:transparent;outline:none;font-family:inherit;font-size:1rem;resize:none;color:var(--text-primary)}.icon-btn,.send-btn{background:none;border:none;cursor:pointer;padding:8px;color:var(--text-primary);display:flex;align-items:center;justify-content:center;transition:opacity .2s}.send-btn{color:var(--primary-color)}.send-btn:disabled{opacity:.5;cursor:default}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background-color:#00000080;z-index:100;display:flex;align-items:flex-end;justify-content:center}.modal-content{background-color:var(--bg-color);width:100%;max-width:600px;border-top-left-radius:16px;border-top-right-radius:16px;padding:20px;animation:slideUp .3s ease-out}@keyframes slideUp{0%{transform:translateY(100%)}to{transform:translateY(0)}}.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.file-list{display:flex;flex-direction:column;gap:12px}.file-item{display:flex;align-items:center;gap:12px;padding:12px;background-color:var(--chat-bg);border-radius:8px;cursor:pointer}.header-icon-btn{position:absolute;right:16px;background:none;border:none;cursor:pointer;color:var(--text-primary);display:flex;align-items:center;justify-content:center;opacity:.7}.profile-manager{display:flex;flex-direction:column;gap:12px;padding-bottom:20px;border-bottom:1px solid var(--border-color);margin-bottom:20px}.profile-select-row{display:flex;gap:8px;align-items:center}.profile-select{flex:1;padding:8px 12px;border-radius:8px;border:1px solid var(--border-color);background-color:var(--chat-bg);color:var(--text-primary);font-family:inherit;font-weight:600}.profile-btn{width:40px;height:38px;display:flex;align-items:center;justify-content:center;border-radius:8px;border:1px solid var(--border-color);background-color:var(--chat-bg);cursor:pointer;color:var(--text-primary);transition:background-color .2s}.profile-btn:hover{background-color:#f0f0f0}.profile-btn.delete{color:#d32f2f;background-color:#ffebee;border-color:#ffcdd2}.profile-name-edit{width:100%;padding:10px;font-size:.9rem;border:none;border-bottom:1px dashed var(--border-color);background:transparent;color:var(--text-primary);font-family:inherit}.profile-name-edit:focus{outline:none;border-bottom-style:solid;border-bottom-color:var(--primary-color)}.icon-settings-row{display:flex;align-items:center;gap:16px;padding:8px 0}.current-icon-preview{background-color:#eee;border-radius:50%;display:flex;align-items:center;justify-content:center;overflow:hidden;border:1px solid var(--border-color);flex-shrink:0}.current-icon-preview img{width:100%;height:100%;object-fit:cover}.icon-actions{display:flex;flex-direction:column;gap:8px;flex:1}.setting-btn{display:flex;align-items:center;gap:6px;padding:6px 12px;background-color:var(--chat-bg);border:1px solid var(--border-color);border-radius:6px;font-size:.85rem;cursor:pointer;color:var(--text-primary);width:fit-content}.setting-btn:hover{background-color:#f0f0f0}.setting-btn.remove{color:#d32f2f;background-color:#ffebee;border-color:#ffcdd2}.size-slider-container{display:flex;align-items:center;gap:10px;margin-top:4px}.size-label{font-size:.8rem;color:#666;width:80px}.icon-size-slider{flex:1;accent-color:var(--primary-color)}.custom-avatar-img{width:100%;height:100%;border-radius:50%;object-fit:cover;object-position:top 35%;transform:scale(2.2);transform-origin:center 35%}.default-avatar-img{width:100%;height:100%;border-radius:50%;object-fit:cover;object-position:center}.memory-settings-container{display:block;overflow-y:auto;max-height:85vh;padding-bottom:20px}.memory-section{display:flex;flex-direction:column;gap:8px;background-color:var(--card-bg);border:1px solid var(--border-color);border-radius:8px;padding:16px;margin-bottom:16px}.section-header{display:flex;align-items:center;gap:8px;color:var(--primary-color)}.setting-label{font-weight:600;font-size:.9rem;color:var(--text-primary)}.system-prompt-input{width:100%;padding:12px;border-radius:8px;border:1px solid var(--border-color);background-color:var(--chat-bg);color:var(--text-primary);font-family:inherit;resize:vertical}.setting-desc{font-size:.8rem;color:#888;margin:0}.danger-zone{margin-top:10px;padding-top:20px;border-top:1px solid var(--border-color);display:flex;justify-content:center}.danger-btn{display:flex;align-items:center;gap:8px;background-color:#ffebee;color:#d32f2f;border:none;padding:10px 20px;border-radius:8px;font-weight:600;cursor:pointer}.crop-modal{max-width:320px;width:90%}.crop-workspace{display:flex;flex-direction:column;align-items:center;gap:16px;padding:10px 0}.crop-area-container{width:200px;height:200px;position:relative;overflow:hidden;background-color:#333;border-radius:8px;cursor:move;touch-action:none;display:flex;align-items:center;justify-content:center}.crop-target-image{max-width:100%;pointer-events:none}.crop-mask{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;background:radial-gradient(circle,transparent 98px,rgba(0,0,0,.5) 100px);border:1px solid rgba(255,255,255,.3);box-sizing:border-box}.crop-controls{display:flex;align-items:center;gap:10px;width:100%;padding:0 10px}.crop-zoom-slider{flex:1;accent-color:var(--primary-color)}.crop-instructions{font-size:.8rem;color:#666;display:flex;align-items:center;gap:6px}.crop-actions{display:flex;gap:10px;width:100%;margin-top:10px}.crop-btn{flex:1;padding:10px;border-radius:8px;border:none;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:6px}.crop-btn.cancel{background-color:#f0f0f0;color:#666}.close-settings-btn{width:100%;padding:12px;margin-top:20px;background-color:#f0f0f0;color:#333;border:none;border-radius:8px;font-weight:600;cursor:pointer;text-align:center}.close-settings-btn:hover{background-color:#e0e0e0}.message-actions{display:flex;align-items:center;gap:8px;margin-top:4px;opacity:.8;min-height:24px}.message-bubble-container{display:flex;flex-direction:column;width:fit-content}.message-bubble.group{position:relative;padding-bottom:24px;min-width:120px}.message-actions{position:absolute;bottom:2px;right:4px;display:flex;gap:4px;opacity:.7;transition:opacity .2s}.message-row:hover .message-actions{opacity:1}.action-btn{background:transparent;border:none;color:inherit;opacity:.6;cursor:pointer;padding:2px;display:flex;align-items:center;border-radius:4px}.action-btn:hover{opacity:1;background-color:#0000000d}.action-btn.delete:hover{color:#d32f2f;background-color:#d32f2f1a}.edit-message-box{background-color:#fff;padding:8px}.header-icon-btn{background:none;border:none;color:#555;cursor:pointer;padding:8px;border-radius:50%;display:flex;align-items:center;justify-content:center}.header-icon-btn:hover{background:#0000000d}.sidebar-overlay{position:fixed;top:0;right:0;bottom:0;left:0;background:#00000080;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);z-index:998;opacity:0;pointer-events:none;transition:opacity .3s ease}.sidebar-overlay.open{opacity:1;pointer-events:auto}.app-sidebar{position:fixed;top:0;left:0;bottom:0;width:280px;background:#f8f9fa;box-shadow:2px 0 12px #0000001a;z-index:999;transform:translate(-100%);transition:transform .3s cubic-bezier(.2,.8,.2,1);display:flex;flex-direction:column;padding:16px}.app-sidebar.open{transform:translate(0)}@media (prefers-color-scheme: dark){.app-sidebar{background:#1a1a1a;border-right:1px solid #333}}.sidebar-header{margin-bottom:20px}.sidebar-header h2{font-size:1.2rem;margin:0 0 12px;font-weight:600;color:#333}@media (prefers-color-scheme: dark){.sidebar-header h2{color:#eee}}.new-chat-btn{width:100%;padding:12px;background:#2196f3;color:#fff;border:none;border-radius:8px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:8px;cursor:pointer;transition:background .2s;box-shadow:0 2px 4px #2196f34d}.new-chat-btn:hover{background:#1976d2}.session-list{flex:1;overflow-y:auto;display:flex;flex-direction:column;gap:4px}.session-item{display:flex;align-items:center;padding:10px;border-radius:8px;cursor:pointer;transition:background .2s;color:#333;border:1px solid transparent}@media (prefers-color-scheme: dark){.session-item{color:#ccc}}.session-item:hover{background:#0000000d}@media (prefers-color-scheme: dark){.session-item:hover{background:#ffffff0d}}.session-item.active{background:#e3f2fd;border-color:#bbdefb}@media (prefers-color-scheme: dark){.session-item.active{background:#1565c0;border-color:#0d47a1;color:#fff}}.session-icon{margin-right:10px;color:#666;flex-shrink:0}.session-item.active .session-icon{color:#1976d2}@media (prefers-color-scheme: dark){.session-item.active .session-icon{color:#fff}}.session-info{flex:1;overflow:hidden;display:flex;flex-direction:column;min-width:0}.session-title-input{background:transparent;border:none;font-size:.95rem;font-weight:500;color:inherit;width:100%;cursor:pointer;text-overflow:ellipsis;outline:none;padding:0;margin:0}.session-title-input:focus{cursor:text;text-decoration:underline}.session-date{font-size:.75rem;color:#888}@media (prefers-color-scheme: dark){.session-date{color:#aaa}}.session-delete-btn{background:none;border:none;color:#999;padding:8px;cursor:pointer;opacity:0;transition:opacity .2s,color .2s;display:flex;align-items:center}.session-item:hover .session-delete-btn{opacity:1}.session-delete-btn:hover{color:#d32f2f;background-color:#d32f2f1a;border-radius:4px}.edit-message-input{width:100%;border:1px solid var(--border-color);border-radius:4px;padding:6px;font-family:inherit;resize:vertical;margin-bottom:6px;color:#333}.edit-actions{display:flex;justify-content:flex-end;gap:6px}.edit-btn{display:flex;align-items:center;justify-content:center;width:30px;height:30px;border-radius:50%;border:none;cursor:pointer}.edit-btn.save{background-color:#4caf50;color:#fff}.edit-btn.cancel{background-color:#f44336;color:#fff}.edit-btn.regenerate{background-color:var(--primary-color);color:#fff}.variant-pager{display:flex;align-items:center;gap:4px;background-color:#0000000d;border-radius:12px;padding:2px}.pager-btn{display:flex;align-items:center;justify-content:center;width:20px;height:20px;border:none;background:transparent;cursor:pointer;border-radius:50%;color:#666}.pager-btn:hover:not(:disabled){background-color:#0000001a}.pager-btn:disabled{opacity:.3;cursor:default}.pager-text{font-size:10px;font-weight:600;color:#666;min-width:30px;text-align:center}.api-key-section{background-color:#646cff1a;padding:12px;border-radius:8px;margin-bottom:16px}.api-key-input{width:100%;padding:10px;border:1px solid var(--border-color);border-radius:6px;font-family:inherit;font-size:14px;background-color:var(--bg-color);color:var(--text-primary)}.api-key-hint{font-size:12px;color:#666;margin-top:6px}.api-key-hint a{color:var(--primary-color)}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.spin{animation:spin 1s linear infinite}.modal-overlay{z-index:9999!important;background-color:#000000d9!important}.modal-content{z-index:10000!important;background-color:var(--card-bg)!important;position:relative!important}.app-container.visual-novel .chat-area{padding-top:12px}.vn-stage{padding-top:60px}
